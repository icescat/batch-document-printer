# 办公文档批量打印器 v4.1 发布说明

## 🐛 Bug修复

### 拖拽导入功能修复
- **修复问题**: 拖拽导入文件名或路径包含空格时导入失败的问题
- **问题描述**: 
  - 文件名包含空格的文件拖拽导入失败
  - 文件夹名包含空格的文件夹拖拽导入失败
  - 完整路径中任何部分包含空格都会导致导入失败
  - 错误提示："未找到支持的文档格式或文件已存在"
- **解决方案**: 
  - 改进拖拽数据解析逻辑，正确处理Windows系统下tkinterdnd2库的特殊格式
  - 处理大括号包围的路径格式
  - 正确转换正斜杠为反斜杠
  - 使用shlex库智能处理包含空格的路径

## 🔧 技术改进

### 代码优化
- 简化拖拽事件处理逻辑
- 移除调试代码，提升运行效率
- 改进错误提示信息的用户友好性

### 兼容性增强
- 更好地支持Windows文件系统的路径格式
- 增强对含有特殊字符文件名的处理能力

## 📦 下载

### 直接下载（推荐）
- **Windows 可执行文件**: `办公文档批量打印器v4.1.exe`
- **文件大小**: 约 30-60MB
- **系统要求**: Windows 10/11 (64位)

### 安装说明
1. 下载 `办公文档批量打印器v4.1.exe`
2. 双击运行即可使用，无需安装
3. 首次启动可能需要10-30秒初始化时间

## 💻 系统要求

- **操作系统**: Windows 10/11 (64位)
- **必需软件**: Microsoft Office (用于Word、PowerPoint和Excel文档)
- **可选软件**: PDF阅读器 (用于PDF文档打印)
- **硬件要求**: 至少一台可用的打印机

## 🆕 升级建议

如果您正在使用v4.0版本，强烈建议升级到v4.1以获得更好的拖拽导入体验，特别是：
- 处理文件名包含空格的文档
- 处理路径中包含空格的文件和文件夹
- 同时拖拽多个文件时的稳定性

## 🐛 已知问题

目前暂无已知问题。如果您在使用过程中遇到任何问题，请通过Issues反馈。

## 📝 更新日志

### v4.1 (2024-12-19)
- 🐛 修复拖拽导入文件名含空格失败的问题
- 🔧 优化拖拽数据解析逻辑
- 🧹 清理调试代码，提升性能

### v4.0 (之前版本)
- ✨ 新增拖拽导入功能
- ✨ 支持直接拖拽文件和文件夹到应用界面
- 📊 页数统计功能增强

---

**开发者**: icescat  
**项目地址**: https://github.com/icescat/batch-document-printer  
**技术支持**: 通过GitHub Issues提交问题和建议 